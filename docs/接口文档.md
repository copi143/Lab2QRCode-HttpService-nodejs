# 接口文档

## 检查版本

检查客户端版本是否为最新版本，如果不是则返回最新版本的下载地址和更新日志。

- **POST** `/update/check_version`
- **请求URL**: `http://域名:端口/update/check_version`
- **Content-Type**: `application/json`

### 请求参数

| 参数名 | 类型 | 必填 | 描述 |
| --- | --- | --- | --- |
| version | string | 是 | 客户端当前版本号 |
| os-arch | string | 是 | 客户端操作系统架构 |

客户端请求参数示例：

```json
{
  "version": "v1.0",
  "os-arch": "windows-x64"
}
```

### 响应参数

| 参数名 | 类型 | 描述 |
| --- | --- | --- |
| version | string | 最新版本号 |
| update_url | string | 更新包下载地址 |
| update_log | string | 更新日志 |

服务器返回参数示例：

```json
{
  "version": "v2.1",
  "update_url": "https://github.com/Mq-b/Lab2QRCode/releases/download/v2.1/Lab2QRCode.zip",
  "update_log": "更新日志"
}
```

### 错误响应

当请求参数不完整时，服务器将返回400状态码：

```json
{
  "error": "Missing required parameters: version and os-arch"
}
```

### 使用场景

客户端应用启动时应该调用此接口来检查是否有新版本可用，如果有，则提示用户进行更新。

因为仅仅检查版本号，即使有更新也只是返回 github 的下载地址，然后客户端自行安装。所以无需担心服务器带宽问题。

具体来说 Lab2QRCode 还需要在每次发布 Release 的时候，ci 自动将更新说明以及 url 上传到配置文件中。

## 注意事项

国内直接下载 github 的 Release 包可能会失败，可以考虑一些其它做法，或者尝试使用代理。例如：<https://ghfast.top/>
